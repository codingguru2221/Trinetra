package com.trinetra.scanner;

import org.junit.Test;
import static org.junit.Assert.*;

/**
 * Unit tests for the VulnerabilityScanner class
 */
public class VulnerabilityScannerTest 
{
    /**
     * Tests that the VulnerabilityScanner can be instantiated
     */
    @Test
    public void testScannerCreation()
    {
        VulnerabilityScanner scanner = new VulnerabilityScanner();
        assertNotNull(scanner);
    }
    
    /**
     * Tests the performScan method with no arguments
     */
    @Test
    public void testPerformScanWithNoArgs()
    {
        VulnerabilityScanner scanner = new VulnerabilityScanner();
        try {
            String[] args = {};
            scanner.performScan(args);
            // If we get here, the method ran without throwing exceptions
            assertTrue(true);
        } catch (Exception e) {
            fail("performScan should handle empty args without throwing exceptions: " + e.getMessage());
        }
    }
    
    /**
     * Tests the performScan method with target argument
     */
    @Test
    public void testPerformScanWithTarget()
    {
        VulnerabilityScanner scanner = new VulnerabilityScanner();
        try {
            String[] args = {"--target", "http://example.com"};
            scanner.performScan(args);
            // If we get here, the method ran without throwing exceptions
            assertTrue(true);
        } catch (Exception e) {
            fail("performScan should handle target args without throwing exceptions: " + e.getMessage());
        }
    }
    
    /**
     * Tests the performScan method with verbose argument
     */
    @Test
    public void testPerformScanWithVerbose()
    {
        VulnerabilityScanner scanner = new VulnerabilityScanner();
        try {
            String[] args = {"--target", "http://example.com", "--verbose"};
            scanner.performScan(args);
            // If we get here, the method ran without throwing exceptions
            assertTrue(true);
        } catch (Exception e) {
            fail("performScan should handle verbose args without throwing exceptions: " + e.getMessage());
        }
    }
    
    /**
     * Tests the performScan method with SQL scan type
     */
    @Test
    public void testPerformScanWithSqlType()
    {
        VulnerabilityScanner scanner = new VulnerabilityScanner();
        try {
            String[] args = {"--target", "http://example.com", "--type", "sql"};
            scanner.performScan(args);
            // If we get here, the method ran without throwing exceptions
            assertTrue(true);
        } catch (Exception e) {
            fail("performScan should handle SQL type args without throwing exceptions: " + e.getMessage());
        }
    }
    
    /**
     * Tests the performScan method with XSS scan type
     */
    @Test
    public void testPerformScanWithXssType()
    {
        VulnerabilityScanner scanner = new VulnerabilityScanner();
        try {
            String[] args = {"--target", "http://example.com", "--type", "xss"};
            scanner.performScan(args);
            // If we get here, the method ran without throwing exceptions
            assertTrue(true);
        } catch (Exception e) {
            fail("performScan should handle XSS type args without throwing exceptions: " + e.getMessage());
        }
    }
}